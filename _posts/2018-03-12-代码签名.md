---
layout: post
title: '代码签名'
subtitle: '签名'
date: 2018-03-12
categories: 技术
cover: 
tags: 逆向tz
---

### RSA
* OpenSSL

<pre><code class="language-objectivec">//生成私钥
$ openssl genrsa -out private.pem 512
Generating RSA private key, 512 bit long modulus
...++++++++++++
......++++++++++++
e is 65537 (0x10001)

//从私钥算出公钥
$ openssl rsa -in private.pem -out public.pem -pubout
writing RSA key

//查看加密信息
$ openssl rsa -in private.pem -text -out private.txt
</code></pre>

* HASH 哈希(散列)函数
    * 不可逆(不能用于加密&解密)
    * 一个二进制数据，只有一个HASH值

* 非对称 RSA (长度在200位以上的数字)
    * 由于是简单的数学计算。所以加密效率比较低...所以一般用于加密核心的(小数据)
    * 公钥加密，私钥解密
    * 私钥加密，公钥加密

### 数字签名

* 客户端 消费¥10 发给服务器
![](https://fuqionglin-blog.oss-cn-qingdao.aliyuncs.com/%E6%BD%AD%E5%B7%9E/%E4%BB%A3%E7%A0%81%E7%AD%BE%E5%90%8D/01.jpg)

* 传递的是二进制。无法保证是否被修改，无法保证安全

* 客户端
    * 二进制数据(消费¥10)。HASH算法，得到HASH值
    * HASH值，使用公钥通过RSA进行加密
    * 再次打包加密(消费¥10+HASH值+公钥加密后的数据)发送。

* 服务端
    * 解密得到 (消费¥10+HASH值+公钥加密后的数据)
    * 私钥解密取出HASH值A
    * 二进制数据(消费¥10)。HASH算法，得到HASH值B
    * 如果A!=B 说明数据被篡改。不可用


