I"È(<h3 id="å¯é€‰é¡¹optional">å¯é€‰é¡¹(Optional)</h3>

<ul>
  <li>å¯é€‰é¡¹ï¼Œä¸€èˆ¬ä¹Ÿå«å¯é€‰ç±»å‹ï¼Œå®ƒå…è®¸å°†å€¼è®¾ç½®ä¸ºnil</li>
  <li>åœ¨ç±»å‹åç§°åé¢åŠ ä¸ªé—®å·? æ¥å®šä¹‰ä¸€ä¸ªå¯é€‰é¡¹</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var name: String? = "Jack"
name = nil

var age: Int? // é»˜è®¤å°±æ˜¯nil
age = 10
age = nil

var array = [1, 15, 40, 29]
func get(_ index: Int) -&gt; Int? {
    if index &lt; 0 || index &gt;= array.count {
        return nil
    }
    return array[index]
}
print(get(1)) // Optional(15)
print(get(-1)) // nil
print(get(4)) // nil
</code></pre></div></div>

<hr />

<h3 id="å¼ºåˆ¶è§£åŒ…forced-unwrapping">å¼ºåˆ¶è§£åŒ…(Forced Unwrapping)</h3>

<ul>
  <li>å¯é€‰é¡¹æ˜¯å¯¹å…¶ä»–ç±»å‹çš„ä¸€å±‚åŒ…è£…ï¼Œå¯ä»¥å°†å®ƒç†è§£ä¸ºä¸€ä¸ªç›’å­
    <ul>
      <li>å¦‚æœä¸ºnilï¼Œé‚£ä¹ˆå®ƒæ˜¯ä¸ªç©ºç›’å­</li>
      <li>å¦‚æœä¸ä¸ºnilï¼Œé‚£ä¹ˆç›’å­é‡Œè£…çš„æ˜¯:è¢«åŒ…è£…ç±»å‹çš„æ•°æ®</li>
    </ul>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var age: Int? // é»˜è®¤å°±æ˜¯nil
age = 10
age = nil
</code></pre></div></div>

<ul>
  <li>å¦‚æœè¦ä»å¯é€‰é¡¹ä¸­å–å‡ºè¢«åŒ…è£…çš„æ•°æ®(å°†ç›’å­é‡Œè£…çš„ä¸œè¥¿å–å‡ºæ¥)ï¼Œéœ€è¦ä½¿ç”¨æ„Ÿå¹å·! è¿›è¡Œå¼ºåˆ¶è§£åŒ…</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var age: Int? = 10
let ageInt: Int = age!
ageInt += 10
</code></pre></div></div>

<ul>
  <li>å¦‚æœå¯¹å€¼ä¸ºnilçš„å¯é€‰é¡¹(ç©ºç›’å­)è¿›è¡Œå¼ºåˆ¶è§£åŒ…ï¼Œå°†ä¼šäº§ç”Ÿè¿è¡Œæ—¶é”™è¯¯</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var age: Int?
age! //Fatal error: Unexpectedly found nil while unwrapping an Optional value
</code></pre></div></div>

<hr />

<h3 id="åˆ¤æ–­å¯é€‰é¡¹æ˜¯å¦åŒ…å«å€¼">åˆ¤æ–­å¯é€‰é¡¹æ˜¯å¦åŒ…å«å€¼</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let number = Int("123")
if number != nil {
    print("å­—ç¬¦ä¸²è½¬æ¢æ•´æ•°æˆåŠŸ:\(number!)")
} else {
    print("å­—ç¬¦ä¸²è½¬æ¢æ•´æ•°å¤±è´¥")
}
// å­—ç¬¦ä¸²è½¬æ¢æ•´æ•°æˆåŠŸ:123
</code></pre></div></div>

<hr />

<h3 id="å¯é€‰é¡¹ç»‘å®šoptional-binding">å¯é€‰é¡¹ç»‘å®š(Optional Binding)</h3>

<ul>
  <li>å¯ä»¥ä½¿ç”¨<strong>å¯é€‰é¡¹ç»‘å®š</strong>æ¥åˆ¤æ–­å¯é€‰é¡¹æ˜¯å¦åŒ…å«å€¼
    <ul>
      <li>å¦‚æœåŒ…å«å°±è‡ªåŠ¨è§£åŒ…ï¼ŒæŠŠå€¼èµ‹ç»™ä¸€ä¸ªä¸´æ—¶çš„å¸¸é‡(<strong>let</strong>)æˆ–è€…å˜é‡(<strong>var</strong>)ï¼Œå¹¶è¿”å›<strong>true</strong>ï¼Œå¦åˆ™è¿”å›<strong>false</strong></li>
    </ul>
  </li>
</ul>

<pre><code class="language-objective-c">if let number = Int("123") {
    print("å­—ç¬¦ä¸²è½¬æ¢æ•´æ•°æˆåŠŸ:\(number)")
    // numberæ˜¯å¼ºåˆ¶è§£åŒ…ä¹‹åçš„Intå€¼
    // numberä½œç”¨åŸŸä»…é™äºè¿™ä¸ªå¤§æ‹¬å·
} else {
    print("å­—ç¬¦ä¸²è½¬æ¢æ•´æ•°å¤±è´¥")
}
// å­—ç¬¦ä¸²è½¬æ¢æ•´æ•°æˆåŠŸ:123

enum Season : Int {
    case spring = 1, summer, autumn, winter
}
if let season = Season(rawValue: 6) {
    switch season { case .spring:
        print("the season is spring")
    default:
        print("the season is other")
    }
} else {
    print("no such season")
}
// no such season
</code></pre>

<hr />

<h3 id="ç­‰ä»·å†™æ³•">ç­‰ä»·å†™æ³•</h3>

<pre><code class="language-objective-c">if let first = Int("4") {
    if let second = Int("42") {
        if first &lt; second &amp;&amp; second &lt; 100 {
            print("\(first) &lt; \(second) &lt; 100")
        }
    }
}
// 4 &lt; 42 &lt; 100

if let first = Int("4"),
    let second = Int("42"),
    first &lt; second &amp;&amp; second &lt; 100 {
    print("\(second) &lt; \(second) &lt; 100")
}
// 4 &lt; 42 &lt; 100
</code></pre>

<hr />

<h3 id="whileå¾ªç¯ä¸­ä½¿ç”¨å¯é€‰é¡¹ç»‘å®š">whileå¾ªç¯ä¸­ä½¿ç”¨å¯é€‰é¡¹ç»‘å®š</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// éå†æ•°ç»„ï¼Œå°†é‡åˆ°çš„æ­£æ•°éƒ½åŠ èµ·æ¥ï¼Œå¦‚æœé‡åˆ°è´Ÿæ•°æˆ–è€…éæ•°å­—ï¼Œåœæ­¢éå†
var strs = ["10", "20", "abc", "-20", "30"]

var index = 0
var sum = 0
while let num = Int(strs[index]), num &gt; 0 {
    sum += num
    index += 1
}
print(sum)
</code></pre></div></div>

<hr />

<h3 id="ç©ºåˆå¹¶è¿ç®—ç¬¦-nil-coalescing-operator">ç©ºåˆå¹¶è¿ç®—ç¬¦ ??(Nil-Coalescing Operator)</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public func ?? &lt;T&gt;(optional: T?, defaultValue: @autoclosure () throws -&gt; T?) rethrows -&gt; T?
public func ?? &lt;T&gt;(optional: T?, defaultValue: @autoclosure () throws -&gt; T) rethrows -&gt; T
</code></pre></div></div>

<ul>
  <li>na ?? bp</li>
  <li>a æ˜¯å¯é€‰é¡¹</li>
  <li>b æ˜¯å¯é€‰é¡¹ æˆ–è€… ä¸æ˜¯å¯é€‰é¡¹</li>
  <li>b è·Ÿ a çš„å­˜å‚¨ç±»å‹å¿…é¡»ç›¸åŒ</li>
  <li>å¦‚æœ a ä¸ä¸ºnilï¼Œå°±è¿”å› a</li>
  <li>å¦‚æœ a ä¸ºnilï¼Œå°±è¿”å› b</li>
  <li>å¦‚æœ b ä¸æ˜¯å¯é€‰é¡¹ï¼Œè¿”å› a æ—¶ä¼šè‡ªåŠ¨è§£åŒ…</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let a: Int? = 1
let b: Int? = 2
let c = a ?? b // cæ˜¯Int? , Optional(1)

let a: Int? = nil
let b: Int? = 2
let c = a ?? b // cæ˜¯Int? , Optional(2)

let a: Int? = nil
let b: Int? = nil
let c = a ?? b // cæ˜¯Int? , nil

let a: Int? = 1
let b: Int = 2
let c = a ?? b // cæ˜¯Int , 1
let a: Int? = nil
let b: Int = 2
let c = a ?? b // cæ˜¯Int , 2

let a: Int? = nil
let b: Int = 2
// å¦‚æœä¸ä½¿ç”¨??è¿ç®—ç¬¦ let c: Int
if let tmp = a {
    c = tmp
} else {
    c=b
}
</code></pre></div></div>

<hr />

<h3 id="å¤šä¸ª--ä¸€èµ·ä½¿ç”¨">å¤šä¸ª ?? ä¸€èµ·ä½¿ç”¨</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let a: Int? = 1
let b: Int? = 2
let c = a ?? b ?? 3 // cæ˜¯Int , 1

let a: Int? = nil
let b: Int? = 2
let c = a ?? b ?? 3 // cæ˜¯Int , 2

let a: Int? = nil
let b: Int? = nil
let c = a ?? b ?? 3 // cæ˜¯Int , 3
</code></pre></div></div>

<hr />

<h3 id="è·Ÿif-leté…åˆä½¿ç”¨">??è·Ÿif leté…åˆä½¿ç”¨</h3>

<pre><code class="language-objective-c">let a: Int? = nil
let b: Int? = 2
if let c = a ?? b {
    print(c)
}
// ç±»ä¼¼äºif a != nil || b != nil

if let c = a, let d = b {
    print(c)
    print(d)
}
// ç±»ä¼¼äºif a != nil &amp;&amp; b != nil
</code></pre>

<hr />

<h3 id="ifè¯­å¥å®ç°ç™»é™†">ifè¯­å¥å®ç°ç™»é™†</h3>

<pre><code class="language-objective-c">func login(_ info: [String : String]) {
    let username: String
    if let tmp = info["username"] {
        username = tmp
    } else {
        print("è¯·è¾“å…¥ç”¨æˆ·å")
        return
    }
    let password: String
    if let tmp = info["password"] {
        password = tmp
    } else {
        print("è¯·è¾“å…¥å¯†ç ")
        return
    }
    // if username ....
    // if password ....
    print("ç”¨æˆ·å:\(username)", "å¯†ç :\(password)", "ç™»é™†ing")
}

login(["username" : "jack", "password" : "123456"]) // ç”¨æˆ·å:jack å¯†ç :123456 ç™»é™†ing
login(["password" : "123456"]) // è¯·è¾“å…¥å¯†ç 
login(["username" : "jack"]) // è¯·è¾“å…¥ç”¨æˆ·å
</code></pre>

<hr />

<h3 id="guardè¯­å¥">guardè¯­å¥</h3>

<ul>
  <li>å½“guardè¯­å¥çš„æ¡ä»¶ä¸ºfalseæ—¶ï¼Œå°±ä¼šæ‰§è¡Œå¤§æ‹¬å·é‡Œé¢çš„ä»£ç </li>
  <li>å½“guardè¯­å¥çš„æ¡ä»¶ä¸ºtrueæ—¶ï¼Œå°±ä¼šè·³è¿‡guardè¯­å¥</li>
  <li>guardè¯­å¥ç‰¹åˆ«é€‚åˆç”¨æ¥â€œæå‰é€€å‡ºâ€</li>
  <li>å½“ä½¿ç”¨guardè¯­å¥è¿›è¡Œå¯é€‰é¡¹ç»‘å®šæ—¶ï¼Œç»‘å®šçš„å¸¸é‡(let)ã€å˜é‡(var)ä¹Ÿèƒ½åœ¨å¤–å±‚ä½œç”¨åŸŸä¸­ä½¿ç”¨</li>
</ul>

<pre><code class="language-objective-c">guard æ¡ä»¶ else {
    // do something....
    é€€å‡ºå½“å‰ä½œç”¨åŸŸ
    // returnã€breakã€continueã€throw error
}


func login(_ info: [String : String]) {
    guard let username = info["username"] else {
        print("è¯·è¾“å…¥ç”¨æˆ·å")
        return
    }
    guard let password = info["password"] else {
        print("è¯·è¾“å…¥å¯†ç ")
        return
    }
    // if username ....
    // if password ....
    print("ç”¨æˆ·å:\(username)", "å¯†ç :\(password)", "ç™»é™†ing")
}
</code></pre>

<hr />

<h3 id="éšå¼è§£åŒ…implicitly-unwrapped-optional">éšå¼è§£åŒ…(Implicitly Unwrapped Optional)</h3>

<ul>
  <li>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯é€‰é¡¹ä¸€æ—¦è¢«è®¾å®šå€¼ä¹‹åï¼Œå°±ä¼šä¸€ç›´æ‹¥æœ‰å€¼</li>
  <li>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥å»æ‰æ£€æŸ¥ï¼Œä¹Ÿä¸å¿…æ¯æ¬¡è®¿é—®çš„æ—¶å€™éƒ½è¿›è¡Œè§£åŒ…ï¼Œå› ä¸ºå®ƒèƒ½ç¡®å®šæ¯æ¬¡è®¿é—®çš„æ—¶å€™éƒ½æœ‰å€¼</li>
  <li>å¯ä»¥åœ¨ç±»å‹åé¢åŠ ä¸ªæ„Ÿå¹å· ! å®šä¹‰ä¸€ä¸ªéšå¼è§£åŒ…çš„å¯é€‰é¡¹</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let num1: Int! = 10
let num2: Int = num1
if num1 != nil {
    print(num1 + 6) // 16
}
if let num3 = num1 {
    print(num3)
}

let num1: Int! = nil
// Fatal error: Unexpectedly found nil while implicitly unwrapping an Optional value
let num2: Int = num1
</code></pre></div></div>

<hr />

<h3 id="å­—ç¬¦ä¸²æ’å€¼">å­—ç¬¦ä¸²æ’å€¼</h3>

<ul>
  <li>å¯é€‰é¡¹åœ¨å­—ç¬¦ä¸²æ’å€¼æˆ–è€…ç›´æ¥æ‰“å°æ—¶ï¼Œç¼–è¯‘å™¨ä¼šå‘å‡ºè­¦å‘Š</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var age: Int? = 10
print("My age is \(age)")
</code></pre></div></div>

<ul>
  <li>è‡³å°‘æœ‰3ç§æ–¹æ³•æ¶ˆé™¤è­¦å‘Š</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>print("My age is \(age!)")
// My age is 10
print("My age is \(String(describing: age))")
// My age is Optional(10)
print("My age is \(age ?? 0)")
// My age is 10
</code></pre></div></div>

<hr />

<h3 id="å¤šé‡å¯é€‰é¡¹">å¤šé‡å¯é€‰é¡¹</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var num1: Int? = 10   //åŒ…è£…äº†ä¸€ä¸ªå¯é€‰ç±»å‹ï¼Œç›’å­é‡Œé¢è£…äº†10
var num2: Int?? = num1  //åŒ…è£…äº†ä¸€ä¸ªå¯é€‰ç±»å‹çš„å¯é€‰ç±»å‹
var num3: Int?? = 10  
print(num2 == num3) // true
</code></pre></div></div>

<ul>
  <li>å¯ä»¥ä½¿ç”¨lldbæŒ‡ä»¤ <strong>frame variable â€“R</strong> æˆ–è€… <strong>fr v â€“R</strong> æŸ¥çœ‹åŒºåˆ«</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var num1: Int? = nil
var num2: Int?? = num1
var num3: Int?? = nil
print(num2 == num3)   // false
(num2 ?? 1) ?? 2      // 2   num2ä¸æ˜¯ç©ºç›’å­ï¼Œ1æ˜¯éå¯é€‰é¡¹ num2è‡ªåŠ¨è§£åŒ…ï¼Œäºæ˜¯ (num1 ?? 2)
(num3 ?? 1) ?? 2      // 1
</code></pre></div></div>

:ET